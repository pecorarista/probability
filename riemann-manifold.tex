\documentclass{ltjsbook}
\usepackage[%
    textwidth=40\zw,
    lines=40,
    centering
]{geometry}
\input{preamble}
\begin{document}
\mainchapter{多様体}

\(2\)点を結ぶ球面上の曲線の中で長さが最小となるのはそれらによって定まる大円の劣弧となることを示す．
計算を簡単にするため\(R = 1\)とする．
地球\(S^2 = S^2(1)\)上の点を球面座標\(\tuple{r, \theta, \varphi}\)で表すことを考える．
動径\(r\)は\(1\)に固定する．
天頂角\(\theta\) \((0 \leq \theta \leq \pi)\)は緯度を用いると
\begin{align*}
    \theta = \begin{cases}
        \displaystyle
        \frac{\pi}{2} - \frac{\alpha^\circ}{180^\circ} \pi
        & \text{北緯\(\alpha^\circ\)のとき，} \\[10pt]
        \displaystyle
        \frac{\pi}{2} + \frac{\alpha^\circ}{180^\circ} \pi
        & \text{南緯\(\alpha^\circ\)のとき．}
    \end{cases}
\end{align*}
これを測地学などの文脈では余緯度(colatitude)と呼ぶ．
方位角\(\varphi\) \((0 \leq \varphi < 2\pi)\)は緯度を用いると以下のように計算できる．
\begin{align*}
    \varphi = \begin{cases}
        \displaystyle
        \frac{\beta^\circ}{180^\circ} \pi
        & \text{東経\(\beta^\circ\)のとき，} \\[10pt]
        \displaystyle
        \pi - \frac{\beta^\circ}{180^\circ} \pi
        & \text{西経\(\beta^\circ\)のとき．}
    \end{cases}
\end{align*}
北極点\(\symup{N} = (0, 0, 1)\)と南極点\(\symup{S} = (0, 0, -1)\)は表し方が一意でないことに注意する．

大円の劣弧が最短距離を与えることを示すにあたり，始点\(p\)を\(\symup{N}\)としても一般性を失わない．
例えば\(p\)の余緯度が\(\theta\)，経度が\(\varphi\)であるとする．
\(\symbb{R}^3\)の点を\(z\)軸まわりに\(-\varphi\)だけ回転させる行列\(R_z(-\varphi)\)と，\(y\)軸まわりに\(-\theta\)だけ回転させる行列\(R_y(-\theta)\)の合成\(A := R_y(-\theta) R_z(-\varphi)\)は長さを保つ．
変換後の\(\symup{N} = Ap\)と\(Aq\)を最短で結ぶ曲線上の点を求め，それに逆の変換\(A^{-1} = R_z(\varphi)R_y(\theta)\)を作用させて元の\(p, q\)を最短で結ぶ曲線が得られる．
\(x = \symup{N}\)から\(p\)とは異なる点\(q\)への曲線\(\gamma \colon [0, 1] \to S^2\)をとる．
これは連続微分可能な関数\(\theta \colon [0, 1] \to [0, \pi], \varphi \colon [0, 1] \to \symbb{R}\)を用いて
\begin{align*}
    \gamma \colon t \mapsto
        \begin{pmatrix}
            \sin \theta(t) \cos \varphi(t) \\
            \sin \theta(t) \sin \varphi(t) \\
            \cos \theta(t)
        \end{pmatrix}
\end{align*}
と表されているとする．
また任意の\(t \in [0, 1]\)で
\begin{align}
    \begin{pmatrix}
        \dot{\theta}(t) \\
        \dot{\varphi}(t)
    \end{pmatrix}
    \neq 0
    \mathlabel{great-circle-regular}
\end{align}
であると仮定する．これは直感的にいうと「停まらない」ということである．
また最短で結ぶ曲線を求めるので\(\gamma\)は自身と交わらない，すなわち単射であると仮定してよい．
曲線の長さ\(L(\gamma)\)は
\begin{align}
    L(\gamma) = \int_{0}^{1} \sqrt{\frac{d\gamma}{dt}(t) \cdot \frac{d\gamma}{dt}(t)} dt
    \mathlabel{great-circle-length-integral}
\end{align}
で求められる．
\begin{align*}
    \frac{\partial \gamma}{\partial \theta}(\theta, \varphi)
    =
    \begin{pmatrix}
        \cos \theta \cos \varphi \\
        \cos \theta \sin \varphi \\
        - \sin \theta
    \end{pmatrix},
    \quad
    \frac{\partial \gamma}{\partial \varphi}(\theta, \varphi)
    =
    \begin{pmatrix}
        - \sin \theta \sin \varphi \\
        \sin \theta \cos \varphi \\
        0
    \end{pmatrix}
\end{align*}
であるから，
\begin{align*}
    \frac{\partial \gamma}{\partial \theta}(\theta, \varphi)
    \cdot
    \frac{\partial \gamma}{\partial \theta}(\theta, \varphi)
    &=
    \begin{pmatrix}
        \cos \theta \cos \varphi \\
        \cos \theta \sin \varphi \\
        - \sin \theta
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        \cos \theta \cos \varphi \\
        \cos \theta \sin \varphi \\
        - \sin \theta
    \end{pmatrix} \\
    &= \cos^2 \theta \cos^2 \varphi
        + \cos^2 \theta \sin^2 \varphi
        + \sin^2 \theta \\
    &= 1,
\end{align*}
\begin{align*}
    \frac{\partial \gamma}{\partial \varphi}(\theta, \varphi)
    \cdot
    \frac{\partial \gamma}{\partial \varphi}(\theta, \varphi)
    &=
    \begin{pmatrix}
        - \sin \theta \sin \varphi \\
        \sin \theta \cos \varphi \\
        0
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        - \sin \theta \sin \varphi \\
        \sin \theta \cos \varphi \\
        0
    \end{pmatrix} \\
    &= \sin^2 \theta \sin^2 \varphi + \sin^2 \theta \cos^2 \varphi \\
    &= \sin^2 \theta,
\end{align*}
\begin{align*}
    \frac{\partial \gamma}{\partial \theta}(\theta, \varphi)
    \cdot
    \frac{\partial \gamma}{\partial \varphi}(\theta, \varphi)
    &=
    \begin{pmatrix}
        \cos \theta \cos \varphi \\
        \cos \theta \sin \varphi \\
        - \sin \theta
    \end{pmatrix}
    \cdot
    \begin{pmatrix}
        - \sin \theta \sin \varphi \\
        \sin \theta \cos \varphi \\
        0
    \end{pmatrix} \\
    &= - \cos \theta \cos \varphi \sin \theta \sin \varphi
       + \cos \theta \sin \varphi \sin \theta \cos \varphi \\
    &= 0.
\end{align*}
積分の計算中に現れる行列の積をあらかじめ計算しておくと
\begin{align*}
    \begin{pmatrix}
        \displaystyle
        \frac{\partial \gamma}{\partial \theta}(\theta, \varphi)
        &
        \displaystyle
        \frac{\partial \gamma}{\partial \varphi}(\theta, \varphi)
    \end{pmatrix}^{\transpose}
    \begin{pmatrix}
        \displaystyle
        \frac{\partial \gamma}{\partial \theta}(\theta, \varphi)
        &
        \displaystyle
        \frac{\partial \gamma}{\partial \varphi}(\theta, \varphi)
    \end{pmatrix}
    =
    \begin{pmatrix}
        1 & 0 \\
        0 & \sin^2 \theta(t) \\
    \end{pmatrix}
\end{align*}
となる．
\(s\)を
\begin{align*}
    s = \int_0^t
        \sqrt{(\dot{\theta}(t))^2 + (\dot{\varphi}(t))^2 \sin^2 \theta(t)}
    dt
\end{align*}
と置くと
\begin{align*}
    \frac{ds}{dt} = \sqrt{(\dot{\theta}(t))^2 + (\dot{\varphi}(t))^2 \sin^2 \theta(t)}.
\end{align*}
以降，表記を簡潔にするため，ニュートンの記法(Newton's notation)を用いる．
これは関数\(f\colon t \mapsto \placeholder\)の\(t\)に関する導関数を\(\dot{f}\)のように表すものである．
\mathref{great-circle-length-integral}の被積分関数を\(F \colon [0, 1] \times \symbb{R}^2 \times \symbb{R}^2 \to \symbb{R}\)は
\begin{align*}
    F\left(
        s,
        \begin{pmatrix}
            \theta(t(s)) \\
            \varphi(t(s))
        \end{pmatrix},
        \begin{pmatrix}
            \dot{\theta}(t(s)) \\
            \dot{\varphi}(t(s)) \\
        \end{pmatrix}
    \right)
    &=
    \sqrt{%
        \begin{pmatrix}
            \dot{\theta} & \dot{\varphi}
        \end{pmatrix}
        \begin{pmatrix}
            1 & 0 \\
            0 & \sin^2 \theta \\
        \end{pmatrix}
        \begin{pmatrix}
            \dot{\theta} \\ \dot{\varphi}
        \end{pmatrix}
    } \\
    &= \sqrt{\dot{\theta}^2 + \dot{\varphi}^2 \sin^2 \theta}.
\end{align*}
この問題のEuler--Lagrange方程式は
\begin{align*}
    \begin{pmatrix}
        \displaystyle
        \frac{\partial F}{\partial \theta}
        &
        \displaystyle
        \frac{\partial F}{\partial \varphi}
    \end{pmatrix}
    -
    \frac{d}{ds}
    \begin{pmatrix}
        \displaystyle
        \frac{\partial F}{\partial \dot{\theta}}
        &
        \displaystyle
        \frac{\partial F}{\partial \dot{\varphi}}
    \end{pmatrix}
    = 0
\end{align*}
である．
\mathref{great-circle-regular}と\(t > 0\)において\(\sin \theta(t) > 0\)であるから，成分ごとに計算して
\begin{numcases}
    \displaystyle
    \frac{%
        \dot{\varphi}^2 \sin \theta \cos \theta
    }{%
        \dfrac{ds}{dt}
    }
    =
    \frac{d}{ds}
    \frac{%
        \dot{\theta}
    }{%
        \dfrac{ds}{dt}
    } \mathlabel{great-circle-ode1} \\[10pt]
    \displaystyle
    0 =
    \frac{d}{ds}
    \frac{%
        \dot{\varphi}(t) \sin^2\theta(t)
    }{%
        \dfrac{ds}{dt}
    } \mathlabel{great-circle-ode2}
\end{numcases}
を得る．
\begin{align*}
    \text{（\mathref{great-circle-ode1}の右辺）}
    = \frac{d}{dt}\left(\frac{d \theta}{dt}\frac{1}{\displaystyle \frac{ds}{dt}}\right)
    = \frac{d}{dt}\left(\frac{d\theta}{ds}(t(s))\right)
\end{align*}
\begin{align*}
    \text{（\mathref{great-circle-ode2}の右辺）}
    = \frac{d}{dt}\left(\frac{d \varphi}{dt}\frac{1}{\displaystyle \frac{ds}{dt}}\sin^2 \theta(t(s))\right)
    = \frac{d}{dt}\left(\frac{d \varphi}{ds}(t(s)) \sin^2 \theta(t(s))\right)
\end{align*}

\mathref{great-circle-ode2}から
\begin{align*}
    \frac{\dot{\varphi}(t) \sin^2\theta(t)}{\sqrt{(\dot{\theta}(t))^2 + (\dot{\varphi}(t))^2 \sin^2 \theta(t)}}
    =
    \frac{\dot{\varphi}(0) \sin^2\theta(0)}{\sqrt{(\dot{\theta}(0))^2 + (\dot{\varphi}(0))^2 \sin^2 \theta(0)}}
\end{align*}
が成り立つ．\(\theta(0) = 0\)から\(0 < t < 1\)において\(\dot{\varphi}(t) = 0\)である．
\(q\)が球面座標で\(\tuple{1, \theta_1, \varphi_1}\)と表されているとき，定数関数\(\varphi\colon t \mapsto \varphi_1\)をとると，\(\dot{\varphi} = 0\)と\(\gamma(1) = q\)をみたす．
\(\theta\)としては例えば\(\theta\colon t \mapsto t \theta_1\)をとればよい．
以上の結果から\(\gamma\)が\(p\)と\(q\)を通る大円の劣弧であることがわかる．

このように\(\symbb{R}^3\)の図形（多様体）の上で\(2\)点を結ぶ最短の曲線を求める問題は，Riemann多様体\(\tuple{M, g}\)上での問題に一般化できる．集合\(\Omega(p, q)\)を
\begin{align*}
    \Omega(p, q) = \{%
        \gamma\colon [a, b] \to M \mid
        \text{\(\gamma\)は区分的に滑らかな曲線で\(\gamma(a) = p\)かつ\(\gamma(b) = q\)}
    \}
\end{align*}
とする．ただし\(\gamma\to [a, b] \to M\)が区分的に滑らかであるとは分割\(a = t_0 < t_1 < \cdots < t_n = b\)が存在して，各区間\([t_{i - 1}, t_i]\)への制限\(\gamma\restriction_{[t_{i - 1}, t_{i}]}\colon [t_{i - 1}, t_i] \to M\)が\(C^\infty\)級であることをいう．
\begin{align*}
    L(\gamma) = \int_{0}^{1} \sqrt{g\left(\frac{d\gamma}{dt}(t), \frac{d\gamma}{dt}(t)\right)} dt
\end{align*}

\begin{align}
    d_g(p, q) = \inf \{L(\gamma) \mid \gamma \in \Omega(p, q)\}
\end{align}
\keyword{Riemann距離}(Riemannian distance)という．
Riemann metricといってしまうと，それはRiemann計量を指すため注意が必要である．


\mathref{great-circle-distance}が距離の公理をみたすことを示す．
以下\(p, q, r\)は\(S^2(R) \subseteq \symbb{R}^3\)の点とする．
最初に非負性を示す．任意の\(x \in [-1 , 1]\)について
\begin{align*}
    0 \leq \arccos x \leq \pi
\end{align*}
から\(d(p, q) \geq 0\)である．
\(d(p, q) = 0\)となるのは\(p \cdot q = \lVert p \rVert \lVert q \rVert\)が成立するときかつそのときに限る．
これはCauchy--Schwarzの不等式において等号が成立する条件と同値であり，ある\(\lambda > 0\)が存在して\(p = \lambda q\)が成り立つということを意味する．
両辺のノルムをとると\(\lambda = 1\)がわかる．
したがって\(p = q\)が\(d(p, q) = 0\)の必要充分条件である．
対称性は\(\symbb{R}^3\)の内積が可換であることから明らかである．
最後に三角不等式を示す．
大円距離はRiemann距離の一例であるからRiemann距離について示せばよい．
任意の\(p, q, r\in M, \gamma_1 \in \Omega(p, r), \gamma_2 \in \Omega(r, q)\)をとる．
下限の定義から，任意の\(\varepsilon > 0\)について\(\gamma_1 \in \Omega(p, r), \gamma_2 \in \Omega(r, q)\)が存在して
\begin{gather*}
    L(\gamma_1) < d_g(p, r) + \frac{\varepsilon}{2},
    \quad
    L(\gamma_2) < d_g(r, q) + \frac{\varepsilon}{2}
\end{gather*}
が成り立つ．したがって
\begin{align*}
    d_g(p, q) \leq L(\gamma_1 + \gamma_2)
            = L(\gamma_1) + L(\gamma_2)
            < d_g(p, r) + d_g(r, q) + \varepsilon.
\end{align*}
\(\varepsilon > 0\)が任意であったから三角不等式\(d_g(p, q) \leq d_g(p, r) + d_g(r, q)\)が成り立つ．

\end{document}
